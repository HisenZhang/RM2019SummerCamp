<launch>

<!--
<arg name="launch_prefix" default="" /> <!- set to value="gdbserver localhost:10000" for remote debugging ->
<arg name="node_namespace" default="apriltag_ros_continuous_node" />
<arg name="debug" default="false"/>
<arg name="device" default="/dev/video0" />
-->

<arg name="launch_prefix" default="" />
<arg name="image_topic" default="image_rect" />

<arg name="node_namespace_front" default="apriltag_front" />
<arg name="node_namespace_back"  default="apriltag_back" />

<arg name="front_camera_device" default="/dev/video0" />
<arg name="front_camera_name"   default="/cam_front" />
<arg name="front_camera_frame"  default="cam_front" />

<arg name="back_camera_device" default="/dev/video1" />
<arg name="back_camera_name"   default="/cam_back" />
<arg name="back_camera_frame"  default="cam_back" />

<!-- front camera -->
<rosparam command="load" file="$(find apriltag_ros)/config/settings.yaml" ns="$(arg node_namespace_front)" />
<rosparam command="load" file="$(find apriltag_ros)/config/tags.yaml"     ns="$(arg node_namespace_front)" />
<node pkg="apriltag_ros" type="apriltag_ros_continuous_node" name="$(arg node_namespace_front)" clear_params="true" output="screen" launch-prefix="$(arg launch_prefix)" >
  <!-- Remap topics from those used in code to those on the ROS network -->
  <remap from="image_rect"  to="$(arg front_camera_name)/$(arg image_topic)" />
  <remap from="camera_info" to="$(arg front_camera_name)/camera_info" />
  <remap from="tag_detections" to="$(arg node_namespace_front)/tag_detections" />

  <param name="camera_frame" type="str" value="$(arg front_camera_frame)" />
  <param name="publish_tag_detections_image" type="bool" value="true" />      <!-- default: false -->
</node>

<!-- Activate Image Processing Node -->
<!-- refer to: http://wiki.ros.org/image_proc  -->
<node ns="usb_cam" pkg="image_proc" type="image_proc" name="image_proc"/>  
<!-- Activate Camera Driver Node -->
<include file="$(find usb_cam)/launch/camera.launch">
  <arg name="debug" value="$(arg debug)" />
  <arg name="device" value="$(arg device)" />
</include>

<!-- show image for debug -->
<group  if="$(arg debug)">
  <node pkg="image_view" type="image_view" name="image_rect" if="$(arg debug)">
  <remap from="image" to="/usb_cam/image_rect_color" />
  <param name="autosize" type="bool" value="true" />
</node>
</group>

<node pkg="rcbigvis" type="vloc" name="vloc" respawn="true" output="screen"/>

<!-- Set static location of base to cam -->
<node pkg="tf2_ros" type="static_transform_publisher" name="base_cam_0" args="-0.06 -0.230 0.645 -1.5707 0 -2.3561 base cam_0" />
<node pkg="tf2_ros" type="static_transform_publisher" name="base_cam_1" args="-0.06 -0.230 0.645 -1.5707 0 -2.3561 base cam_1" />

<!-- Set static location of tags -->
<node pkg="rcbigvis" type="tags_lut" name="tags_lut" respawn="true" output="screen"/>

</launch>
